:root{
  --hdr-h: 100px;
  --fg:#eadfcb; --muted:#b7b0a0; --accent:#d4af37; --accent-2:#89b4ff;
  --glass:rgba(234,223,203,.06); --border:rgba(234,223,203,.14); --blur:16px;
  /* æ”¶èµ·æ—¶äº‘æœµä½¿ç”¨å’Œåº•éƒ¨ä¸€è‡´çš„é»‘è‰²ä¸é€æ˜èƒŒæ™¯ */
  --solid-1:#0c1220; --solid-2:#080c18;
}

/* -------- Insight Panelï¼ˆå³ä¾§ï¼‰ -------- */
.insight-panel{
  position: fixed;
  top: calc(var(--hdr-h) + 12px);
  bottom: 18px;
  z-index: 3;
  width: 220px;
  padding: 10px;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(12,18,32,.86), rgba(8,12,24,.86));
  border: 1px solid var(--border);
  box-shadow: 0 20px 50px rgba(0,0,0,.42), 0 0 0 1px rgba(137,180,255,.06) inset;
  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));
  display: grid;
  grid-template-rows: auto auto auto auto; /* hdr + list + footnote + CSV */
  gap: 8px;
  transform: translateX(0);
  transition: transform .32s cubic-bezier(.22,1,.36,1), opacity .2s ease;
}
.insight-panel.right{ right: 12px; left: auto; }
.insight-panel.is-collapsed{ transform: translateX(calc(100% + 10px)); opacity: .95; pointer-events: none; }

/* Headerï¼šäº‘æœµ + ğŸ“ˆï¼ˆå”¯ä¸€å…¥å£ï¼‰ */
.insight-hdr{
  display: flex;
  align-items: center;
  gap: 8px;
}

/* äº‘æœµåˆ‡æ¢æŒ‰é’® */
.icon-btn.insight-toggle{
  width: 28px; height: 28px; border-radius: 999px;
  background: var(--glass); border: 1px solid var(--border); color: var(--fg);
  display: grid; place-items: center; cursor: pointer;
  transition: transform .12s ease, border-color .2s ease, box-shadow .2s ease, background .2s ease;
}
.icon-btn.insight-toggle:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--border) 70%, var(--accent) 30%);
  box-shadow: 0 8px 20px rgba(0,0,0,.35);
}
.icon-btn.insight-toggle:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 70%, #fff 30%);
  outline-offset: 2px;
}

/* ğŸ“ˆ å”¯ä¸€å…¥å£æŒ‰é’®ï¼ˆå›¾æ ‡æ¬¾ï¼‰ */
.icon-btn.graph-toggle{
  width: 28px; height: 28px; border-radius: 999px;
  background: var(--glass); border: 1px solid var(--border); color: var(--fg);
  display: grid; place-items: center; cursor: pointer;
  transition: transform .12s ease, border-color .2s ease, box-shadow .2s ease, background .2s ease;
}
.icon-btn.graph-toggle:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--border) 60%, var(--accent) 40%);
  box-shadow: 0 8px 20px rgba(0,0,0,.35), 0 0 22px rgba(212,175,55,.18) inset;
}
.icon-btn.graph-toggle:active{ transform: translateY(1px); }
.icon-btn.graph-toggle:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 70%, #fff 30%);
  outline-offset: 2px;
}

/* KPI åˆ—è¡¨ï¼ˆä¸¤åˆ—ï¼šåœ†ç¯ + æ–‡æœ¬ï¼‰ */
.kpi-list.mini{ display: grid; gap: 8px; }
.kpi-row.mini{
  display: grid; grid-template-columns: 42px 1fr; align-items: center;
  padding: 10px; border-radius: 12px;
  background: rgba(234,223,203,.05);
  border: 1px solid var(--border);
}

/* åœ†ç¯ä»ªè¡¨ */
.kpi-row.mini .gauge{
  --gcolor: var(--accent);
  --p: 0;
  position: relative;
  width: 40px; height: 40px; border-radius: 50%;
  background: transparent;
  display: grid; place-items: center;
}
/* åº•è½¨ */
.kpi-row.mini .gauge::before{
  content:"";
  position:absolute; inset:0; border-radius:50%;
  background: conic-gradient(rgba(255,255,255,.10) 0 360deg);
  mask: radial-gradient(circle at 50% 50%, transparent 48%, #000 63%);
  box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
  z-index: 1; pointer-events:none;
}
/* è¿›åº¦ç¯ */
.kpi-row.mini .gauge::after{
  content:"";
  position:absolute; inset:0; border-radius:50%;
  background: conic-gradient(var(--gcolor) calc(var(--p)*1%), rgba(255,255,255,0) 0);
  mask: radial-gradient(circle at 50% 50%, transparent 48%, #000 63%);
  box-shadow: 0 0 22px rgba(212,175,55,.20);
  z-index: 1; pointer-events:none;
}
/* ä¸­å¤®ç™¾åˆ†æ¯”æ–‡æœ¬ */
.kpi-row.mini .gauge .gauge-val{
  position:absolute; inset:0;
  display:grid; place-items:center;
  font-size:12px; font-weight:800; color:var(--fg);
  text-shadow: 0 0 4px rgba(0,0,0,.35);
  z-index: 2; pointer-events:none;
}

.kpi.high .gauge{ --gcolor: #ffd166; }
.kpi.medium .gauge{ --gcolor: #f59e0b; }
.kpi.low .gauge{ --gcolor: #60a5fa; }

/* KPI æ–‡æ¡ˆ */
.kpi-text.mini .lab-short{
  font-size:12px; font-weight:800; color:rgba(255,255,255,.92);
  line-height:1.05;
}
.kpi-text.mini .meta{
  font-size: 11px; line-height:1.05; color:#fff; opacity:1;
  margin-top: 2px;
}

/* è„šæ³¨ */
.footnote-left.mini{ font-size: 11px; color: var(--muted); }
.footnote-left.mini .justify{
  text-align: left; text-justify: inter-word;
}
.footnote-left.mini .justify::after{
  content:""; display:inline-block; width:100%;
}

/* CSV æŒ‰é’®ï¼ˆç¬¬ä¸€é¡¹ç›®é£æ ¼ï¼‰ */
.csv-btn.mini{
  height: 34px; padding: 0 10px; border-radius: 10px; text-align: center;
  background: var(--glass); border: 1px solid var(--border); color: var(--fg);
  cursor: pointer;
}
.csv-btn.mini:hover{ transform: translateY(-1px); }

/* æ”¶èµ·æ—¶å³ä¾§çš„äº‘æœµâ€œå°æ ‡ç­¾â€ */
.insight-tab.mini.right{
  position: fixed; right: 6px; top: calc(var(--hdr-h) + 12px);
  z-index: 3; width: 30px; height: 30px; border-radius: 999px;
  background: var(--glass); border: 1px solid var(--border); color: var(--fg);
  display: grid; place-items: center; cursor: pointer;
  box-shadow: 0 10px 26px rgba(0,0,0,.28);
}
.insight-tab.mini.right.dark{
  background: linear-gradient(180deg, var(--solid-1), var(--solid-2));
  border: 1px solid var(--border);
}

/* çŠ¶æ€æ ·å¼ */
.insight-loading{ display:flex; align-items:center; gap:8px; font-size:12px; }
.spinner{ width:18px; height:18px; border-radius:50%; border:2px solid rgba(234,223,203,.2); border-top-color:var(--accent); animation: spin .8s linear infinite; }
@keyframes spin{ to{ transform:rotate(360deg); } }
.insight-error{ font-size:12px; color:#ff6b6b; }
.insight-hint{ font-size:12px; opacity:.9; text-align: center; color: whitesmoke;}

/* ===== ä¸­å¤®å¼¹å±‚ ===== */
.insight-modal{
  position: fixed;
  inset: 0;
  z-index: 6000;
  display: grid;
  place-items: center;
}
.insight-modal__backdrop{
  position: absolute;
  inset: 0;
  background: color-mix(in oklab, #000 70%, transparent);
  backdrop-filter: blur(2px);
}
.insight-modal__panel{
  position: relative;
  width: min(960px, calc(100vw - 40px));
  max-height: min(82vh, 860px);
  overflow: hidden;
  border-radius: 16px;
  background: var(--glass);
  border: 1px solid var(--border);
  color: var(--fg);
  box-shadow:
    0 1px 0 color-mix(in oklab, var(--border) 80%, transparent),
    0 20px 60px color-mix(in oklab, #000 75%, transparent);
  backdrop-filter: blur(var(--blur));
  display: grid;
  grid-template-rows: auto 1fr;
  animation: modal-pop .18s ease-out;
}
@keyframes modal-pop{
  from{ transform: translateY(8px) scale(.98); opacity: 0; }
  to{ transform: translateY(0) scale(1); opacity: 1; }
}
.insight-modal__hdr{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
  background:
    linear-gradient(180deg,
      color-mix(in oklab, var(--glass) 90%, transparent),
      color-mix(in oklab, var(--glass) 60%, transparent)
    );
}
.insight-modal__title{
  font-size: 13px;
  font-weight: 700;
  letter-spacing: .2px;
  color: var(--fg);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.icon-btn.modal-close{
  height: 32px;
  width: 32px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--glass);
  color: var(--fg);
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: background .2s ease, border-color .2s ease, transform .12s ease;
}
.icon-btn.modal-close:hover{
  background: color-mix(in oklab, var(--glass) 75%, var(--accent) 25%);
  border-color: color-mix(in oklab, var(--border) 70%, var(--accent) 30%);
}
.icon-btn.modal-close:active{ transform: translateY(1px); }

.insight-modal__body{
  padding: 12px;
  overflow: auto;
  background:
    linear-gradient(180deg,
      color-mix(in oklab, var(--solid-1) 80%, transparent),
      color-mix(in oklab, var(--solid-2) 65%, transparent)
    );
}

/* å°å±é€‚é… */
@media (max-width: 480px){
  .insight-modal__panel{
    width: calc(100vw - 20px);
    max-height: 86vh;
    border-radius: 14px;
  }
  .insight-modal__hdr{
    padding: 10px 12px;
  }
  .insight-modal__title{
    font-size: 12px;
  }
}


